{% extends "modern/base.html" %}

{% set active_page = "dashboard" %}

{% block title %}HR Dashboard - HR Management System{% endblock %}

{% block extra_css %}
<style>
    .stats-card {
        transition: all 0.3s;
    }
    
    .stats-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 0.5rem 2rem rgba(0, 0, 0, 0.15) !important;
    }
    
    .stats-icon {
        font-size: 2rem;
        opacity: 0.4;
    }
    
    .recent-employees-table img {
        height: 40px;
        width: 40px;
    }
    
    .action-required-list .list-group-item {
        border-left: 3px solid transparent;
        transition: all 0.2s;
    }
    
    .action-required-list .list-group-item:hover {
        background-color: #f8f9fc;
        transform: translateX(3px);
    }
    
    .action-required-list .list-group-item.priority-high {
        border-left-color: var(--danger-color);
    }
    
    .action-required-list .list-group-item.priority-medium {
        border-left-color: var(--warning-color);
    }
    
    .action-required-list .list-group-item.priority-low {
        border-left-color: var(--info-color);
    }
    
    .chart-container {
        height: 300px;
    }
    
    .department-stats {
        transition: all 0.3s;
    }
    
    .department-stats:hover {
        background-color: #f8f9fc;
    }
    
    .badge-outline {
        background-color: transparent;
        border: 1px solid;
    }
    
    .badge-outline-success {
        color: var(--success-color);
        border-color: var(--success-color);
    }
    
    .badge-outline-danger {
        color: var(--danger-color);
        border-color: var(--danger-color);
    }
    
    .badge-outline-warning {
        color: var(--warning-color);
        border-color: var(--warning-color);
    }
    
    .status-indicator {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        display: inline-block;
        margin-right: 5px;
    }
    
    .status-active {
        background-color: var(--success-color);
    }
    
    .status-inactive {
        background-color: var(--secondary-color);
    }
    
    .status-pending {
        background-color: var(--warning-color);
    }
    
    .calendar-dropdown button {
        background: transparent;
        border: 1px solid #e3e6f0;
        border-radius: 0.35rem;
        padding: 0.25rem 1rem;
        font-weight: 400;
        color: #5a5c69;
    }
</style>
{% endblock %}

{% block content %}
<!-- Page Heading -->
<div class="d-sm-flex align-items-center justify-content-between mb-4">
    <h1 class="h3 mb-0 text-gray-800">HR Dashboard</h1>
    <div class="d-flex">
        <div class="dropdown calendar-dropdown me-2">
            <button class="btn dropdown-toggle" type="button" id="calendarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="fas fa-calendar-alt me-1"></i> April 2025
            </button>
            <ul class="dropdown-menu" aria-labelledby="calendarDropdown">
                <li><a class="dropdown-item" href="#">March 2025</a></li>
                <li><a class="dropdown-item" href="#">April 2025</a></li>
                <li><a class="dropdown-item" href="#">May 2025</a></li>
            </ul>
        </div>
        <a href="#" class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm">
            <i class="fas fa-download fa-sm text-white-50"></i> Generate Report
        </a>
    </div>
</div>

<!-- Content Row -->
<div class="row">
    <!-- Total Employees Card -->
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-primary shadow h-100 py-2 stats-card">
            <div class="card-body">
                <div class="row no-gutters align-items-center">
                    <div class="col-auto pe-3">
                        <i class="fas fa-users fa-2x text-gray-300 stats-icon"></i>
                    </div>
                    <div class="col">
                        <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                            Total Employees</div>
                        <div class="h5 mb-0 font-weight-bold text-gray-800">215</div>
                        <div class="small text-success mt-2">
                            <i class="fas fa-arrow-up"></i> 3.2% from last month
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Present Today Card -->
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-success shadow h-100 py-2 stats-card">
            <div class="card-body">
                <div class="row no-gutters align-items-center">
                    <div class="col-auto pe-3">
                        <i class="fas fa-calendar-check fa-2x text-gray-300 stats-icon"></i>
                    </div>
                    <div class="col">
                        <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                            Present Today</div>
                        <div class="h5 mb-0 font-weight-bold text-gray-800">198</div>
                        <div class="small text-muted mt-2">
                            92% attendance rate
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Pending Leave Requests Card -->
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-warning shadow h-100 py-2 stats-card">
            <div class="card-body">
                <div class="row no-gutters align-items-center">
                    <div class="col-auto pe-3">
                        <i class="fas fa-calendar-alt fa-2x text-gray-300 stats-icon"></i>
                    </div>
                    <div class="col">
                        <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                            Pending Leave Requests</div>
                        <div class="h5 mb-0 font-weight-bold text-gray-800">12</div>
                        <div class="small text-primary mt-2">
                            <a href="#">View all</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Open Job Positions Card -->
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-info shadow h-100 py-2 stats-card">
            <div class="card-body">
                <div class="row no-gutters align-items-center">
                    <div class="col-auto pe-3">
                        <i class="fas fa-user-plus fa-2x text-gray-300 stats-icon"></i>
                    </div>
                    <div class="col">
                        <div class="text-xs font-weight-bold text-info text-uppercase mb-1">
                            Open Job Positions</div>
                        <div class="h5 mb-0 font-weight-bold text-gray-800">8</div>
                        <div class="small text-primary mt-2">
                            <a href="#">Manage jobs</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Content Row -->
<div class="row">
    <!-- Department Distribution Chart -->
    <div class="col-lg-5">
        <div class="card shadow mb-4">
            <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                <h6 class="m-0 font-weight-bold text-primary">Department Distribution</h6>
                <div class="dropdown no-arrow">
                    <a class="dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i>
                    </a>
                    <div class="dropdown-menu dropdown-menu-end shadow animated--fade-in" aria-labelledby="dropdownMenuLink">
                        <div class="dropdown-header">Chart Options:</div>
                        <a class="dropdown-item" href="#">Export as image</a>
                        <a class="dropdown-item" href="#">View detailed report</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#">Add department</a>
                    </div>
                </div>
            </div>
            <div class="card-body">
                <div class="chart-container">
                    <canvas id="departmentDistributionChart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- Department Stats -->
        <div class="card shadow mb-4">
            <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">Department Stats</h6>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover mb-0">
                        <thead class="table-light">
                            <tr>
                                <th>Department</th>
                                <th>Employees</th>
                                <th>Avg. Performance</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="department-stats">
                                <td>Information Technology</td>
                                <td>45</td>
                                <td>
                                    <div class="d-flex align-items-center">
                                        <div class="progress progress-sm flex-grow-1 me-2" style="height: 5px;">
                                            <div class="progress-bar bg-success" role="progressbar" style="width: 84%" aria-valuenow="84" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                        <div>84%</div>
                                    </div>
                                </td>
                                <td><span class="badge bg-success">Active</span></td>
                            </tr>
                            <tr class="department-stats">
                                <td>Human Resources</td>
                                <td>12</td>
                                <td>
                                    <div class="d-flex align-items-center">
                                        <div class="progress progress-sm flex-grow-1 me-2" style="height: 5px;">
                                            <div class="progress-bar bg-success" role="progressbar" style="width: 78%" aria-valuenow="78" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                        <div>78%</div>
                                    </div>
                                </td>
                                <td><span class="badge bg-success">Active</span></td>
                            </tr>
                            <tr class="department-stats">
                                <td>Finance</td>
                                <td>18</td>
                                <td>
                                    <div class="d-flex align-items-center">
                                        <div class="progress progress-sm flex-grow-1 me-2" style="height: 5px;">
                                            <div class="progress-bar bg-info" role="progressbar" style="width: 72%" aria-valuenow="72" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                        <div>72%</div>
                                    </div>
                                </td>
                                <td><span class="badge bg-success">Active</span></td>
                            </tr>
                            <tr class="department-stats">
                                <td>Marketing</td>
                                <td>23</td>
                                <td>
                                    <div class="d-flex align-items-center">
                                        <div class="progress progress-sm flex-grow-1 me-2" style="height: 5px;">
                                            <div class="progress-bar bg-warning" role="progressbar" style="width: 65%" aria-valuenow="65" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                        <div>65%</div>
                                    </div>
                                </td>
                                <td><span class="badge bg-success">Active</span></td>
                            </tr>
                            <tr class="department-stats">
                                <td>Sales</td>
                                <td>38</td>
                                <td>
                                    <div class="d-flex align-items-center">
                                        <div class="progress progress-sm flex-grow-1 me-2" style="height: 5px;">
                                            <div class="progress-bar bg-info" role="progressbar" style="width: 76%" aria-valuenow="76" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                        <div>76%</div>
                                    </div>
                                </td>
                                <td><span class="badge bg-success">Active</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
                            
    <div class="col-lg-7">
        <div class="row">
            <div class="col-12">
                <!-- Attendance Overview Chart -->
                <div class="card shadow mb-4">
                    <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                        <h6 class="m-0 font-weight-bold text-primary">Attendance Overview (Last 30 Days)</h6>
                        <div class="dropdown no-arrow">
                            <a class="dropdown-toggle" href="#" role="button" id="attendanceDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i>
                            </a>
                            <div class="dropdown-menu dropdown-menu-end shadow animated--fade-in" aria-labelledby="attendanceDropdown">
                                <a class="dropdown-item" href="#">Monthly view</a>
                                <a class="dropdown-item" href="#">Weekly view</a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="#">Export data</a>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="attendanceOverviewChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
                        
            <div class="col-md-6">
                <!-- Recent Employees -->
                <div class="card shadow mb-4">
                    <div class="card-header py-3">
                        <h6 class="m-0 font-weight-bold text-primary">Recent Hires</h6>
                    </div>
                    <div class="card-body">
                        <div class="recent-employees-table">
                            <div class="d-flex align-items-center py-2 border-bottom">
                                <div class="flex-shrink-0 me-3">
                                    <div class="bg-primary rounded-circle d-flex justify-content-center align-items-center text-white" style="width: 40px; height: 40px;">
                                        <i class="fas fa-user"></i>
                                    </div>
                                </div>
                                <div class="flex-grow-1">
                                    <h6 class="mb-0">Sarah Johnson</h6>
                                    <div class="small text-muted">Software Developer</div>
                                </div>
                                <div class="text-muted small">
                                    2d ago
                                </div>
                            </div>
                            <div class="d-flex align-items-center py-2 border-bottom">
                                <div class="flex-shrink-0 me-3">
                                    <div class="bg-info rounded-circle d-flex justify-content-center align-items-center text-white" style="width: 40px; height: 40px;">
                                        <i class="fas fa-user"></i>
                                    </div>
                                </div>
                                <div class="flex-grow-1">
                                    <h6 class="mb-0">Michael Chen</h6>
                                    <div class="small text-muted">UI/UX Designer</div>
                                </div>
                                <div class="text-muted small">
                                    5d ago
                                </div>
                            </div>
                            <div class="d-flex align-items-center py-2 border-bottom">
                                <div class="flex-shrink-0 me-3">
                                    <div class="bg-success rounded-circle d-flex justify-content-center align-items-center text-white" style="width: 40px; height: 40px;">
                                        <i class="fas fa-user"></i>
                                    </div>
                                </div>
                                <div class="flex-grow-1">
                                    <h6 class="mb-0">Jessica Williams</h6>
                                    <div class="small text-muted">Marketing Specialist</div>
                                </div>
                                <div class="text-muted small">
                                    1w ago
                                </div>
                            </div>
                            <div class="d-flex align-items-center py-2">
                                <div class="flex-shrink-0 me-3">
                                    <div class="bg-warning rounded-circle d-flex justify-content-center align-items-center text-white" style="width: 40px; height: 40px;">
                                        <i class="fas fa-user"></i>
                                    </div>
                                </div>
                                <div class="flex-grow-1">
                                    <h6 class="mb-0">David Rodriguez</h6>
                                    <div class="small text-muted">Financial Analyst</div>
                                </div>
                                <div class="text-muted small">
                                    2w ago
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer bg-transparent">
                        <a href="#" class="text-primary small">View all employees →</a>
                    </div>
                </div>
            </div>
                        
            <div class="col-md-6">
                <!-- Upcoming Reviews & Birthdays -->
                <div class="card shadow mb-4">
                    <div class="card-header py-3">
                        <ul class="nav nav-tabs card-header-tabs" id="upcoming-tab" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="reviews-tab" data-bs-toggle="tab" data-bs-target="#reviews" type="button" role="tab" aria-controls="reviews" aria-selected="true">Upcoming Reviews</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="birthdays-tab" data-bs-toggle="tab" data-bs-target="#birthdays" type="button" role="tab" aria-controls="birthdays" aria-selected="false">Employee Birthdays</button>
                            </li>
                        </ul>
                    </div>
                    <div class="card-body">
                        <div class="tab-content" id="upcoming-tabContent">
                            <div class="tab-pane fade show active" id="reviews" role="tabpanel" aria-labelledby="reviews-tab">
                                <div class="d-flex align-items-center py-2 border-bottom">
                                    <div class="me-3 text-center">
                                        <div class="bg-light rounded px-2 py-1">
                                            <div class="fw-bold">28</div>
                                            <div class="small">APR</div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="fw-bold">Robert Smith</div>
                                        <div class="small text-muted">Annual Performance Review</div>
                                    </div>
                                </div>
                                <div class="d-flex align-items-center py-2 border-bottom">
                                    <div class="me-3 text-center">
                                        <div class="bg-light rounded px-2 py-1">
                                            <div class="fw-bold">03</div>
                                            <div class="small">MAY</div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="fw-bold">Maria Garcia</div>
                                        <div class="small text-muted">Quarterly Review</div>
                                    </div>
                                </div>
                                <div class="d-flex align-items-center py-2 border-bottom">
                                    <div class="me-3 text-center">
                                        <div class="bg-light rounded px-2 py-1">
                                            <div class="fw-bold">05</div>
                                            <div class="small">MAY</div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="fw-bold">James Johnson</div>
                                        <div class="small text-muted">Probation Review</div>
                                    </div>
                                </div>
                                <div class="d-flex align-items-center py-2">
                                    <div class="me-3 text-center">
                                        <div class="bg-light rounded px-2 py-1">
                                            <div class="fw-bold">08</div>
                                            <div class="small">MAY</div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="fw-bold">Patricia Wilson</div>
                                        <div class="small text-muted">Annual Performance Review</div>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="birthdays" role="tabpanel" aria-labelledby="birthdays-tab">
                                <div class="d-flex align-items-center py-2 border-bottom">
                                    <div class="me-3 text-center">
                                        <div class="bg-light rounded px-2 py-1">
                                            <div class="fw-bold">30</div>
                                            <div class="small">APR</div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="fw-bold">Karen Thompson</div>
                                        <div class="small text-muted">Project Manager</div>
                                    </div>
                                </div>
                                <div class="d-flex align-items-center py-2 border-bottom">
                                    <div class="me-3 text-center">
                                        <div class="bg-light rounded px-2 py-1">
                                            <div class="fw-bold">02</div>
                                            <div class="small">MAY</div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="fw-bold">Daniel Lee</div>
                                        <div class="small text-muted">Senior Developer</div>
                                    </div>
                                </div>
                                <div class="d-flex align-items-center py-2 border-bottom">
                                    <div class="me-3 text-center">
                                        <div class="bg-light rounded px-2 py-1">
                                            <div class="fw-bold">05</div>
                                            <div class="small">MAY</div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="fw-bold">Emily Clark</div>
                                        <div class="small text-muted">UX Designer</div>
                                    </div>
                                </div>
                                <div class="d-flex align-items-center py-2">
                                    <div class="me-3 text-center">
                                        <div class="bg-light rounded px-2 py-1">
                                            <div class="fw-bold">10</div>
                                            <div class="small">MAY</div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="fw-bold">Richard Taylor</div>
                                        <div class="small text-muted">Sales Manager</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Action Required -->
                <div class="card shadow mb-4">
                    <div class="card-header py-3">
                        <h6 class="m-0 font-weight-bold text-primary">Action Required</h6>
                    </div>
                    <div class="card-body p-0">
                        <div class="action-required-list list-group list-group-flush">
                            <a href="#" class="list-group-item list-group-item-action priority-high d-flex align-items-center">
                                <div class="me-3">
                                    <div class="icon-circle bg-danger">
                                        <i class="fas fa-exclamation-triangle text-white"></i>
                                    </div>
                                </div>
                                <div class="flex-grow-1">
                                    <div class="fw-bold">12 leave applications pending approval</div>
                                    <div class="small text-muted">Requires immediate attention</div>
                                </div>
                                <div>
                                    <i class="fas fa-chevron-right"></i>
                                </div>
                            </a>
                            <a href="#" class="list-group-item list-group-item-action priority-medium d-flex align-items-center">
                                <div class="me-3">
                                    <div class="icon-circle bg-warning">
                                        <i class="fas fa-clock text-white"></i>
                                    </div>
                                </div>
                                <div class="flex-grow-1">
                                    <div class="fw-bold">Payroll processing due in 3 days</div>
                                    <div class="small text-muted">April 2025 salary processing</div>
                                </div>
                                <div>
                                    <i class="fas fa-chevron-right"></i>
                                </div>
                            </a>
                            <a href="#" class="list-group-item list-group-item-action priority-low d-flex align-items-center">
                                <div class="me-3">
                                    <div class="icon-circle bg-info">
                                        <i class="fas fa-clipboard-list text-white"></i>
                                    </div>
                                </div>
                                <div class="flex-grow-1">
                                    <div class="fw-bold">3 new job applications require screening</div>
                                    <div class="small text-muted">Senior Developer position</div>
                                </div>
                                <div>
                                    <i class="fas fa-chevron-right"></i>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener("DOMContentLoaded", function() {
        // Department Distribution Chart
        var departmentCtx = document.getElementById('departmentDistributionChart').getContext('2d');
        var departmentChart = new Chart(departmentCtx, {
            type: 'doughnut',
            data: {
                labels: ['IT', 'HR', 'Finance', 'Marketing', 'Sales', 'Operations', 'R&D'],
                datasets: [{
                    data: [45, 12, 18, 23, 38, 32, 47],
                    backgroundColor: [
                        '#4e73df',
                        '#1cc88a',
                        '#36b9cc',
                        '#f6c23e',
                        '#e74a3b',
                        '#6f42c1',
                        '#fd7e14'
                    ],
                    hoverOffset: 4
                }]
            },
            options: {
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'right',
                    }
                },
                cutout: '70%'
            }
        });

        // Attendance Overview Chart
        var attendanceCtx = document.getElementById('attendanceOverviewChart').getContext('2d');
        var attendanceChart = new Chart(attendanceCtx, {
            type: 'bar',
            data: {
                labels: ['Mar 28', 'Mar 29', 'Mar 30', 'Mar 31', 'Apr 1', 'Apr 2', 'Apr 3', 'Apr 4', 'Apr 5', 'Apr 6', 'Apr 7', 'Apr 8', 'Apr 9', 'Apr 10', 'Apr 11', 'Apr 12', 'Apr 13', 'Apr 14', 'Apr 15', 'Apr 16', 'Apr 17', 'Apr 18', 'Apr 19', 'Apr 20', 'Apr 21', 'Apr 22', 'Apr 23', 'Apr 24', 'Apr 25', 'Apr 26'],
                datasets: [{
                    label: 'Present',
                    backgroundColor: '#1cc88a',
                    data: [198, 185, 190, 195, 192, 197, 185, 164, 162, 200, 198, 195, 197, 190, 196, 192, 140, 145, 197, 194, 192, 196, 195, 175, 165, 194, 196, 198, 195, 198]
                },
                {
                    label: 'Absent',
                    backgroundColor: '#e74a3b',
                    data: [17, 30, 25, 20, 23, 18, 30, 51, 53, 15, 17, 20, 18, 25, 19, 23, 75, 70, 18, 21, 23, 19, 20, 40, 50, 21, 19, 17, 20, 17]
                }]
            },
            options: {
                maintainAspectRatio: false,
                scales: {
                    x: {
                        stacked: true,
                        grid: {
                            display: false
                        }
                    },
                    y: {
                        stacked: true,
                        grid: {
                            borderDash: [2],
                            color: 'rgba(0, 0, 0, 0.1)'
                        }
                    }
                },
                plugins: {
                    legend: {
                        position: 'top'
                    }
                }
            }
        });
    });
</script>
{% endblock %}